{"version":3,"file":"fn.js","sourceRoot":"","sources":["fn.ts"],"names":[],"mappings":";;;AAAA,+BAA4B;AAC5B,gEAAwD;AACxD,2BAA6D;AAC7D,oDAAoD;AAE7C,KAAK,UAAU,iBAAiB,CAAC,GAAY;IAEnD,MAAM,QAAQ,GAAG,IAAA,wBAAY,EAAC;QAC7B,GAAG;KACH,CAAC,CAAC;IACH,IAAI,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,IAAI,EAClB;QACC,MAAM,IAAI,GAAG,IAAA,WAAI,EAAC,QAAQ,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QAE9C,IAAI,IAAA,eAAU,EAAC,IAAI,CAAC,EACpB;YACC,MAAM,IAAI,GAAG,IAAA,iBAAY,EAAC,IAAI,EAAE,OAAO,CAAC,CAAC;YAEzC,IAAI,GAAG,GAAG,IAAA,4BAAU,EAAC,IAAI,CAAC,CAAC;YAE3B,IAAI,GAAG,CAAC,gBAAgB,EACxB;gBACC,IAAA,kBAAa,EAAC,IAAI,EAAE,GAAG,CAAC,YAAY,CAAC,CAAC;aACtC;YAED,OAAO;gBACN,GAAG,GAAG;gBACN,QAAQ;gBACR,IAAI;aACJ,CAAA;SACD;QAED,OAAO;YACN,QAAQ;SACA,CAAA;KACT;AACF,CAAC;AA/BD,8CA+BC","sourcesContent":["import { join } from 'path';\nimport { yarnDedupe } from '@yarn-tool/yarnlock-dedupe';\nimport { readFileSync, writeFileSync, existsSync } from 'fs';\nimport { findRootLazy } from '@yarn-tool/find-root';\n\nexport async function autoDeduplication(cwd?: string)\n{\n\tconst rootData = findRootLazy({\n\t\tcwd,\n\t});\n\tif (rootData?.root)\n\t{\n\t\tconst file = join(rootData.root, 'yarn.lock');\n\n\t\tif (existsSync(file))\n\t\t{\n\t\t\tconst data = readFileSync(file, 'utf-8');\n\n\t\t\tlet ret = yarnDedupe(data);\n\n\t\t\tif (ret.yarnlock_changed)\n\t\t\t{\n\t\t\t\twriteFileSync(file, ret.yarnlock_new);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t...ret,\n\t\t\t\trootData,\n\t\t\t\tfile,\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\trootData,\n\t\t} as null\n\t}\n}\n\n"]}
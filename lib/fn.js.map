{"version":3,"file":"fn.js","sourceRoot":"","sources":["fn.ts"],"names":[],"mappings":";;;AAAA,+BAA4B;AAC5B,gEAAwD;AACxD,2BAAiD;AACjD,oDAAoD;AAE7C,KAAK,UAAU,iBAAiB,CAAC,GAAY;IAEnD,MAAM,QAAQ,GAAG,IAAA,wBAAY,EAAC;QAC7B,GAAG;KACH,CAAC,CAAC;IACH,IAAI,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,IAAI,EAClB;QACC,MAAM,IAAI,GAAG,IAAA,WAAI,EAAC,QAAQ,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QAE9C,MAAM,IAAI,GAAG,IAAA,iBAAY,EAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAEzC,IAAI,GAAG,GAAG,IAAA,4BAAU,EAAC,IAAI,CAAC,CAAC;QAE3B,IAAI,GAAG,CAAC,gBAAgB,EACxB;YACC,IAAA,kBAAa,EAAC,IAAI,EAAE,GAAG,CAAC,YAAY,CAAC,CAAC;SACtC;QAED,OAAO;YACN,GAAG,GAAG;YACN,QAAQ;YACR,IAAI;SACJ,CAAA;KACD;AACF,CAAC;AAxBD,8CAwBC","sourcesContent":["import { join } from 'path';\nimport { yarnDedupe } from '@yarn-tool/yarnlock-dedupe';\nimport { readFileSync, writeFileSync } from 'fs';\nimport { findRootLazy } from '@yarn-tool/find-root';\n\nexport async function autoDeduplication(cwd?: string)\n{\n\tconst rootData = findRootLazy({\n\t\tcwd,\n\t});\n\tif (rootData?.root)\n\t{\n\t\tconst file = join(rootData.root, 'yarn.lock');\n\n\t\tconst data = readFileSync(file, 'utf-8');\n\n\t\tlet ret = yarnDedupe(data);\n\n\t\tif (ret.yarnlock_changed)\n\t\t{\n\t\t\twriteFileSync(file, ret.yarnlock_new);\n\t\t}\n\n\t\treturn {\n\t\t\t...ret,\n\t\t\trootData,\n\t\t\tfile,\n\t\t}\n\t}\n}\n\n"]}